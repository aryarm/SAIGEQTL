Loading required package: optparse
R version 4.2.0 (2022-04-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 18.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] optparse_1.7.1 SAIGE_1.1.4   

loaded via a namespace (and not attached):
[1] compiler_4.2.0     Matrix_1.4-1       Rcpp_1.0.7         getopt_1.20.3     
[5] grid_4.2.0         data.table_1.14.2  RcppParallel_5.0.2 lattice_0.20-45   
$plinkFile
[1] ""

$bedFile
[1] ""

$bimFile
[1] ""

$famFile
[1] ""

$phenoFile
[1] "./GMMAT_pheno_quantitative_repeat.txt"

$phenoCol
[1] "y.repeated"

$traitType
[1] "quantitative"

$invNormalize
[1] FALSE

$covarColList
[1] "sex"

$qCovarColList
[1] ""

$sampleIDColinphenoFile
[1] "id"

$tol
[1] 0.02

$maxiter
[1] 20

$tolPCG
[1] 1e-05

$maxiterPCG
[1] 500

$nThreads
[1] 1

$SPAcutoff
[1] 2

$numRandomMarkerforVarianceRatio
[1] 30

$skipModelFitting
[1] FALSE

$skipVarianceRatioEstimation
[1] TRUE

$memoryChunk
[1] 2

$tauInit
[1] "0,0"

$LOCO
[1] TRUE

$isLowMemLOCO
[1] FALSE

$traceCVcutoff
[1] 0.0025

$nrun
[1] 20

$ratioCVcutoff
[1] 0.001

$outputPrefix
[1] "GMMAT_quantitative_multiV_1.1.4"

$outputPrefix_varRatio
[1] ""

$IsOverwriteVarianceRatioFile
[1] FALSE

$sparseGRMFile
[1] "./GMMAT_GRM.mtx"

$sparseGRMSampleIDFile
[1] "./GMMAT_sampleID.txt"

$isCateVarianceRatio
[1] FALSE

$relatednessCutoff
[1] 0

$cateVarRatioMinMACVecExclude
[1] "10,20.5"

$cateVarRatioMaxMACVecInclude
[1] "20.5"

$isCovariateTransform
[1] FALSE

$isDiagofKinSetAsOne
[1] FALSE

$useSparseGRMtoFitNULL
[1] TRUE

$useSparseGRMforVarRatio
[1] FALSE

$minMAFforGRM
[1] 0.01

$maxMissingRateforGRM
[1] 0.15

$minCovariateCount
[1] -1

$includeNonautoMarkersforVarRatio
[1] FALSE

$FemaleOnly
[1] FALSE

$MaleOnly
[1] FALSE

$sexCol
[1] ""

$FemaleCode
[1] "1"

$MaleCode
[1] "0"

$isCovariateOffset
[1] FALSE

$SampleIDIncludeFile
[1] ""

$VmatFilelist
[1] "I.mtx"

$VmatSampleFilelist
[1] "./GMMAT_sampleID.txt"

$help
[1] FALSE

tauInit  is  0 0 
cateVarRatioMinMACVecExclude  is  10 20.5 
cateVarRatioMaxMACVecInclude  is  20.5 
Sparse GRM is used to fit the null model and plink file is not specified, so variance ratios won't be estimated
Variance ratio estimation will be skipped
.Leave-one-chromosome-out is not applied
400  samples are in the sparse GRM
formula is  y.repeated~sex 
2000  samples have non-missing phenotypes
Duplicated sample IDs are detected in the phenotype file. Assuming repeated measurements
400  samples in geno file do not have phenotypes
0  samples will be used for analysis
2000  obsevations will be used for analysis
    IID X.Intercept. sex y.repeated IndexPheno IndexGeno
1     1            1   0       1.74        752         1
2     1            1   0       1.58       1537         1
3     1            1   0       2.20        885         1
4     1            1   0       2.41       1117         1
5     1            1   0       1.83       1036         1
556   2            1   1       2.11       1517         2
extract sparse GRM
[1] 160000
set elements in the sparse GRM <=  0  to zero
2000  observations have been used to fit the glmm null model
Setting up sparse GRM using  ./GMMAT_GRM.mtx  and  ./GMMAT_sampleID.txt 
Dimension of the sparse GRM is  2000 2000 
2 locationMat.n_rows 
4000000 locationMat.n_cols 
4000000 valueVec.n_elem 
1  additional variance covariance matrices are specified
Extract matrix in  I.mtx 
[1] 400
2000  samples have been used to fit the glmm null model
Kmat_vec.size() 1
Markers in the Plink file with MAF <  0.01  will be removed before constructing GRM
Markers in the Plink file with missing rate >  0.15  will be removed before constructing GRM
y.repeated  is a quantitative trait
glm:

Call:  glm(formula = formula.new, family = gaussian(link = "identity"), 
    data = data.new)

Coefficients:
(Intercept)          sex  
     1.0237       0.6141  

Degrees of Freedom: 1999 Total (i.e. Null);  1998 Residual
Null Deviance:	    2076 
Residual Deviance: 1888 	AIC: 5566
Start fitting the NULL GLMM
   user  system elapsed 
  3.598   0.408   4.059 
   user  system elapsed 
  3.698   0.411   4.163 
[1] "Start reading genotype plink file here"
Error! fam file not open!time: 0.138
[1] "Genotype reading is done"
tauInit[1] 0 0 0
inital tau is  0.3461869 0.3461869 0.3461869 
use sparse kinship to fit the model 
after Sigma_iY
use sparse kinship to fit the model 
use sparse kinship to fit the model 
Tau:
[1] 0.3461869 0.3461869 0.3461869
Fixed-effect coefficients:
          [,1]
[1,] 0.9869654
[2,] 0.6133700
[1] "alpha"
          [,1]
[1,] 0.9869654
[2,] 0.6133700
k1 3
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
AI
   1.9652e+04   9.7247e+01   1.1584e+02
   9.7247e+01   4.3043e+02   4.8624e+02
   1.1584e+02   4.8624e+02   5.7921e+02
idxtau
        0
        1
        2
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update20 3
CV for trace random estimator using 20 runs is    0.0006
   0.0027
   0.0028
 > 0.0025
try 30runs
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update30 3
YPAPY_update
   6.8772e+03
   3.5100e+02
   4.0895e+02
Trace
   4.7309e+03
   4.8137e+02
   5.5864e+02
Variance component estimates:
[1] 0.4747989 0.3383753 0.3372167

Iteration  1 0.4747989 0.3383753 0.3372167 :
tau0_v1:  0.4747989 0.3383753 0.3372167 
use sparse kinship to fit the model 
after Sigma_iY
use sparse kinship to fit the model 
use sparse kinship to fit the model 
Tau:
[1] 0.4747989 0.3383753 0.3372167
Fixed-effect coefficients:
          [,1]
[1,] 0.9870970
[2,] 0.6133956
[1] "alpha"
          [,1]
[1,] 0.9870970
[2,] 0.6133956
t_end_Get_Coef - t_begin_Get_Coef
   user  system elapsed 
  2.118   0.167   2.287 
k1 3
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
AI
   7.6308e+03   9.3205e+01   1.1093e+02
   9.3205e+01   4.1448e+02   4.6602e+02
   1.1093e+02   4.6602e+02   5.5464e+02
idxtau
        0
        1
        2
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update20 3
CV for trace random estimator using 20 runs is    0.0006
   0.0027
   0.0028
 > 0.0025
try 30runs
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update30 3
YPAPY_update
   3.6921e+03
   3.4165e+02
   3.9739e+02
Trace
   3.4781e+03
   4.7494e+02
   5.5072e+02
YPAPY
   3.6921e+03
   3.4165e+02
   3.9739e+02
Trace
   3.4781e+03
   4.7494e+02
   5.5072e+02
score
   2.1397e+02
  -1.3328e+02
  -1.5333e+02
Dtau
   0.0322
  -0.1942
  -0.1197
score1
   2.1397e+02
  -1.3328e+02
  -1.5333e+02
AI1
   7.6308e+03   9.3205e+01   1.1093e+02
   9.3205e+01   4.1448e+02   4.6602e+02
   1.1093e+02   4.6602e+02   5.5464e+02
t_end_fitglmmaiRPCG - t_begin_fitglmmaiRPCG
   user  system elapsed 
 23.790   2.184  25.977 
[1] 0.03209634 0.38630197 0.20836771
tau:  0.5069514 0.1442213 0.2174704 
tau0:  0.4747989 0.3383753 0.3372167 

Iteration  2 0.5069514 0.1442213 0.2174704 :
tau0_v1:  0.5069514 0.1442213 0.2174704 
use sparse kinship to fit the model 
after Sigma_iY
use sparse kinship to fit the model 
use sparse kinship to fit the model 
Tau:
[1] 0.5069514 0.1442213 0.2174704
Fixed-effect coefficients:
          [,1]
[1,] 0.9887530
[2,] 0.6136081
[1] "alpha"
          [,1]
[1,] 0.9887530
[2,] 0.6136081
t_end_Get_Coef - t_begin_Get_Coef
   user  system elapsed 
  2.040   0.172   2.212 
k1 3
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
AI
   6.3464e+03   4.0607e+02   4.7794e+02
   4.0607e+02   1.9224e+03   2.0303e+03
   4.7794e+02   2.0303e+03   2.3897e+03
idxtau
        0
        1
        2
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update20 3
CV for trace random estimator using 20 runs is    0.0005
   0.0027
   0.0028
 > 0.0025
try 30runs
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update30 3
YPAPY_update
   3.3798e+03
   9.2464e+02
   1.0548e+03
Trace
   3.3338e+03
   7.8056e+02
   8.9738e+02
YPAPY
   3.3798e+03
   9.2464e+02
   1.0548e+03
Trace
   3.3338e+03
   7.8056e+02
   8.9738e+02
score
   4.6015e+01
   1.4408e+02
   1.5741e+02
Dtau
   0.0023
   0.0524
   0.0209
score1
   4.6015e+01
   1.4408e+02
   1.5741e+02
AI1
   6.3464e+03   4.0607e+02   4.7794e+02
   4.0607e+02   1.9224e+03   2.0303e+03
   4.7794e+02   2.0303e+03   2.3897e+03
t_end_fitglmmaiRPCG - t_begin_fitglmmaiRPCG
   user  system elapsed 
 23.471   2.152  25.627 
[1] 0.002243541 0.145194505 0.043911373
tau:  0.5092762 0.1966123 0.238365 
tau0:  0.5069514 0.1442213 0.2174704 

Iteration  3 0.5092762 0.1966123 0.238365 :
tau0_v1:  0.5092762 0.1966123 0.238365 
use sparse kinship to fit the model 
after Sigma_iY
use sparse kinship to fit the model 
use sparse kinship to fit the model 
Tau:
[1] 0.5092762 0.1966123 0.2383650
Fixed-effect coefficients:
          [,1]
[1,] 0.9878860
[2,] 0.6135179
[1] "alpha"
          [,1]
[1,] 0.9878860
[2,] 0.6135179
t_end_Get_Coef - t_begin_Get_Coef
   user  system elapsed 
  2.014   0.188   2.203 
k1 3
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
AI
   6.2287e+03   2.6657e+02   3.1558e+02
   2.6657e+02   1.2206e+03   1.3329e+03
   3.1558e+02   1.3329e+03   1.5779e+03
idxtau
        0
        1
        2
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update20 3
CV for trace random estimator using 20 runs is    0.0005
   0.0027
   0.0028
 > 0.0025
try 30runs
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update30 3
YPAPY_update
   3.2998e+03
   6.9345e+02
   7.9889e+02
Trace
   3.2961e+03
   6.7651e+02
   7.8097e+02
YPAPY
   3.2998e+03
   6.9345e+02
   7.9889e+02
Trace
   3.2961e+03
   6.7651e+02
   7.8097e+02
score
    3.6489
   16.9378
   17.9163
Dtau
   1.0653e-05
   1.9044e-02
  -4.7340e-03
score1
    3.6489
   16.9378
   17.9163
AI1
   6.2287e+03   2.6657e+02   3.1558e+02
   2.6657e+02   1.2206e+03   1.3329e+03
   3.1558e+02   1.3329e+03   1.5779e+03
t_end_fitglmmaiRPCG - t_begin_fitglmmaiRPCG
   user  system elapsed 
 23.422   2.219  25.646 
[1] 1.027307e-05 4.405521e-02 9.621987e-03
tau:  0.5092869 0.215656 0.233631 
tau0:  0.5092762 0.1966123 0.238365 

Iteration  4 0.5092869 0.215656 0.233631 :
tau0_v1:  0.5092869 0.215656 0.233631 
use sparse kinship to fit the model 
after Sigma_iY
use sparse kinship to fit the model 
use sparse kinship to fit the model 
Tau:
[1] 0.5092869 0.2156560 0.2336310
Fixed-effect coefficients:
          [,1]
[1,] 0.9875764
[2,] 0.6134765
[1] "alpha"
          [,1]
[1,] 0.9875764
[2,] 0.6134765
t_end_Get_Coef - t_begin_Get_Coef
   user  system elapsed 
  2.014   0.204   2.218 
k1 3
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
AI
   6.2243e+03   2.4909e+02   2.9549e+02
   2.4909e+02   1.1274e+03   1.2455e+03
   2.9549e+02   1.2455e+03   1.4775e+03
idxtau
        0
        1
        2
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update20 3
CV for trace random estimator using 20 runs is    0.0005
   0.0027
   0.0028
 > 0.0025
try 30runs
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
use sparse kinship to fit the model 
dim temp_mat_update30 3
YPAPY_update
   3.2927e+03
   6.6097e+02
   7.6426e+02
Trace
   3.2926e+03
   6.6058e+02
   7.6383e+02
YPAPY
   3.2927e+03
   6.6097e+02
   7.6426e+02
Trace
   3.2926e+03
   6.6058e+02
   7.6383e+02
score
   0.0864
   0.3931
   0.4330
Dtau
  -2.9656e-08
   3.6138e-04
  -1.1525e-05
score1
   0.0864
   0.3931
   0.4330
AI1
   6.2243e+03   2.4909e+02   2.9549e+02
   2.4909e+02   1.1274e+03   1.2455e+03
   2.9549e+02   1.2455e+03   1.4775e+03
t_end_fitglmmaiRPCG - t_begin_fitglmmaiRPCG
   user  system elapsed 
 23.642   1.992  25.639 
[1] 0.000000e+00 8.000980e-04 2.363999e-05
tau:  0.5092869 0.2160174 0.2336195 
tau0:  0.5092869 0.215656 0.233631 

Final  0.5092869 0.2160174 0.2336195 :
use sparse kinship to fit the model 
after Sigma_iY
use sparse kinship to fit the model 
use sparse kinship to fit the model 
Tau:
[1] 0.5092869 0.2160174 0.2336195
Fixed-effect coefficients:
          [,1]
[1,] 0.9875722
[2,] 0.6134757
[1] "alpha"
          [,1]
[1,] 0.9875722
[2,] 0.6134757
t_end_null - t_begin, fitting the NULL model without LOCO took
   user  system elapsed 
130.434  11.950 142.409 
    IID X.Intercept. sex y.repeated IndexPheno IndexGeno covoffset
1     1            1   0       1.74        752         1         0
2     1            1   0       1.58       1537         1         0
3     1            1   0       2.20        885         1         0
4     1            1   0       2.41       1117         1         0
5     1            1   0       1.83       1036         1         0
556   2            1   1       2.11       1517         2         0
    sex
1     0
2     0
3     0
4     0
5     0
556   1
[1] 0.6134757
use sparse kinship to fit the model 
use sparse kinship to fit the model 
   user  system elapsed 
135.490  12.497 148.067 
t_end - t_begin, fitting the NULL model took
   user  system elapsed 
131.892  12.089 144.008 
Skip estimating variance ratios
closed the plinkFile!
